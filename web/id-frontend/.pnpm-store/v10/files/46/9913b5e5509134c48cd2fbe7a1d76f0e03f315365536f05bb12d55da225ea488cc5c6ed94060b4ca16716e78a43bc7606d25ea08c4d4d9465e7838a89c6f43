{"version":3,"file":"Drawer.js","sourceRoot":"../../../../../src","sources":["components/Drawer/components/Drawer.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport {\n    FloatingFocusManager,\n    FloatingNode,\n    FloatingOverlay,\n    useDismiss,\n    useFloating,\n    useFloatingNodeId,\n    useInteractions,\n    useRole,\n} from '@floating-ui/react';\n\nimport type {ModalProps} from 'src/components/Modal';\n\nimport {useForkRef} from '../../../hooks';\nimport {useFloatingTransition} from '../../../hooks/private/useFloatingTransition';\nimport {Portal} from '../../Portal';\nimport {block} from '../../utils/cn';\nimport {filterDOMProps} from '../../utils/filterDOMProps';\nimport {DRAWER_ANIMATION_DURATION_MS} from '../constants';\nimport type {DrawerPlacement, OnResizeHandler} from '../hooks/useResizeHandlers';\nimport i18n from '../i18n';\n\nimport {DrawerItem} from './DrawerItem';\n\nimport './Drawer.scss';\n\nconst b = block('drawer');\n\nexport interface DrawerProps\n    extends Omit<\n        ModalProps,\n        | 'disableHeightTransition'\n        | 'onClose'\n        | 'onEscapeKeyDown'\n        | 'onEnterKeyDown'\n        | 'onOutsideClick'\n        | 'contentOverflow'\n    > {\n    /**\n     * Specifies the side from which the drawer should slide in, `left` by default.\n     * @default left\n     */\n    placement?: DrawerPlacement;\n    /**\n     * Enables resizing of the drawer via pointer.\n     * @default false\n     */\n    resizable?: boolean;\n    /**\n     * Width of the drawer in pixels.\n     */\n    size?: number;\n    /**\n     * Min width of the drawer in pixels.\n     */\n    minSize?: number;\n    /**\n     * Max width of the drawer in pixels.\n     */\n    maxSize?: number;\n    /**\n     * Callback called at the start of resizing.\n     */\n    onResizeStart?: OnResizeHandler;\n    /**\n     * Callback called when the drawer is being resized.\n     */\n    onResize?: OnResizeHandler;\n    /**\n     * Callback called at the end of resizing.\n     */\n    onResizeEnd?: OnResizeHandler;\n}\n\nexport const Drawer = ({\n    open,\n    onOpenChange,\n    placement = 'left',\n    children,\n    contentClassName,\n    resizable = false,\n    size,\n    minSize,\n    maxSize,\n    onResizeStart,\n    onResizeEnd,\n    onResize,\n    className,\n    style,\n    qa,\n    disableEscapeKeyDown,\n    disableOutsideClick,\n    initialFocus,\n    returnFocus,\n    disableBodyScrollLock = false,\n    disableVisuallyHiddenDismiss,\n    onTransitionIn,\n    onTransitionInComplete,\n    onTransitionOut,\n    onTransitionOutComplete,\n    floatingRef,\n    disablePortal,\n    keepMounted = false,\n    container,\n    ...restProps\n}: DrawerProps) => {\n    const floatingNodeId = useFloatingNodeId();\n\n    const {refs, context} = useFloating({\n        nodeId: floatingNodeId,\n        open,\n        onOpenChange,\n    });\n    const overlayRef = React.useRef(null);\n\n    const {isMounted, status} = useFloatingTransition({\n        context,\n        duration: DRAWER_ANIMATION_DURATION_MS,\n        onTransitionIn,\n        onTransitionInComplete,\n        onTransitionOut,\n        onTransitionOutComplete,\n    });\n\n    const dismiss = useDismiss(context, {\n        enabled: !disableEscapeKeyDown || !disableOutsideClick,\n        outsidePress: (event) => {\n            if (disableOutsideClick) {\n                return false;\n            }\n\n            const isOwnOutsideClick =\n                (event.target as HTMLElement).closest(`.${b()}`) === overlayRef.current;\n\n            if (!isOwnOutsideClick) {\n                return false;\n            }\n\n            return true;\n        },\n        escapeKey: !disableEscapeKeyDown,\n    });\n\n    const role = useRole(context, {role: 'dialog'});\n    const {getFloatingProps} = useInteractions([dismiss, role]);\n    /*\n     *  TODO: Remove casting in React 19 (https://github.com/gravity-ui/uikit/issues/2537)\n     */\n    const handleFloatingRef = useForkRef<HTMLDivElement>(\n        refs.setFloating,\n        floatingRef as React.Ref<HTMLDivElement>,\n    );\n\n    const portal =\n        isMounted || keepMounted ? (\n            <Portal container={container} disablePortal={disablePortal}>\n                <FloatingOverlay\n                    style={style}\n                    ref={overlayRef}\n                    className={b(\n                        {\n                            open,\n                            placement,\n                        },\n                        className,\n                    )}\n                    data-qa={qa}\n                    data-floating-ui-status={status}\n                    lockScroll={!disableBodyScrollLock}\n                >\n                    <FloatingFocusManager\n                        context={context}\n                        disabled={!isMounted}\n                        modal={isMounted}\n                        initialFocus={initialFocus ?? refs.floating}\n                        returnFocus={returnFocus}\n                        visuallyHiddenDismiss={disableVisuallyHiddenDismiss ? false : i18n('close')}\n                        restoreFocus={true}\n                    >\n                        <DrawerItem\n                            ref={handleFloatingRef}\n                            open={open}\n                            placement={placement}\n                            className={contentClassName}\n                            resizable={resizable}\n                            size={size}\n                            onResize={onResize}\n                            onResizeStart={onResizeStart}\n                            onResizeEnd={onResizeEnd}\n                            minSize={minSize}\n                            maxSize={maxSize}\n                            overlayRef={overlayRef}\n                            {...filterDOMProps(restProps, {labelable: true})}\n                            {...getFloatingProps()}\n                        >\n                            {children}\n                        </DrawerItem>\n                    </FloatingFocusManager>\n                </FloatingOverlay>\n            </Portal>\n        ) : null;\n\n    return <FloatingNode id={floatingNodeId}>{portal}</FloatingNode>;\n};\n"]}