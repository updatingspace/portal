{"version":3,"file":"useResizableDrawerItem.js","sourceRoot":"../../../../../src","sources":["components/Drawer/hooks/useResizableDrawerItem.ts"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport type {DrawerPlacement} from '..';\nimport {DRAWER_ITEM_INITIAL_SIZE, DRAWER_ITEM_MAX_SIZE, DRAWER_ITEM_MIN_SIZE} from '../constants';\n\nimport type {OnResizeHandler} from './useResizeHandlers';\nimport {useResizeHandlers} from './useResizeHandlers';\n\nexport interface UseResizableDrawerItemParams {\n    placement?: DrawerPlacement;\n    size?: number;\n    minSize?: number;\n    maxSize?: number;\n    onResizeStart?: OnResizeHandler;\n    onResizeEnd?: OnResizeHandler;\n    onResize?: OnResizeHandler;\n    overlayRef: React.RefObject<HTMLElement>;\n}\n\nexport function useResizableDrawerItem(params: UseResizableDrawerItemParams) {\n    const {\n        placement = 'left',\n        size,\n        minSize = DRAWER_ITEM_MIN_SIZE,\n        maxSize = DRAWER_ITEM_MAX_SIZE,\n        onResizeStart,\n        onResizeEnd,\n        onResize,\n        overlayRef,\n    } = params;\n\n    const isHorizontal = ['left', 'right'].includes(placement);\n    const getOverlayMaxSize = React.useCallback(() => {\n        return isHorizontal\n            ? (overlayRef.current?.clientWidth ?? 0)\n            : (overlayRef.current?.clientHeight ?? 0);\n    }, [isHorizontal, overlayRef]);\n\n    const [isResizing, setIsResizing] = React.useState(false);\n    const [resizeDelta, setResizeDelta] = React.useState(0);\n    const [internalSize, setInternalSize] = React.useState(size ?? DRAWER_ITEM_INITIAL_SIZE);\n\n    const getClampedSize = React.useCallback(\n        (curSize: number) => Math.min(Math.max(curSize, minSize), maxSize),\n        [minSize, maxSize],\n    );\n\n    const getResizedSize = React.useCallback(\n        (delta: number) => {\n            const signedDelta = ['right', 'bottom'].includes(placement) ? delta : -delta;\n            const overlaySize = getOverlayMaxSize();\n            const newSize = Math.min(internalSize + signedDelta, overlaySize);\n            return getClampedSize(newSize);\n        },\n        [internalSize, placement, getClampedSize, getOverlayMaxSize],\n    );\n\n    const onStart = React.useCallback(() => {\n        setIsResizing(true);\n        setResizeDelta(0);\n        onResizeStart?.(getResizedSize(0));\n    }, [onResizeStart, getResizedSize]);\n\n    const onMove = React.useCallback(\n        (delta: number) => {\n            setResizeDelta(delta);\n            onResize?.(getResizedSize(delta));\n        },\n        [getResizedSize, onResize],\n    );\n\n    const onEnd = React.useCallback(\n        (delta: number) => {\n            const newSize = getResizedSize(delta);\n            setIsResizing(false);\n            setInternalSize(newSize);\n\n            onResizeEnd?.(newSize);\n        },\n        [getResizedSize, onResizeEnd],\n    );\n\n    const displaySize = isResizing\n        ? getResizedSize(resizeDelta)\n        : getClampedSize(size ?? internalSize);\n\n    const {onPointerDown: onResizerPointerDown} = useResizeHandlers({\n        onStart,\n        onMove,\n        onEnd,\n        arrangement: isHorizontal ? 'horizontal' : 'vertical',\n    });\n\n    const handleCommonResize = React.useCallback(() => {\n        const overlaySize = getOverlayMaxSize();\n\n        if (overlaySize >= internalSize) {\n            return;\n        }\n\n        setInternalSize(Math.max(minSize, overlaySize));\n        onResize?.(overlaySize);\n        onResizeEnd?.(overlaySize);\n    }, [getOverlayMaxSize, minSize, internalSize, onResize, onResizeEnd]);\n\n    React.useEffect(() => {\n        window.addEventListener('resize', handleCommonResize);\n\n        return () => {\n            window.removeEventListener('resize', handleCommonResize);\n        };\n    }, [handleCommonResize]);\n\n    return {\n        currentSize: displaySize,\n        onResizerPointerDown,\n    };\n}\n"]}