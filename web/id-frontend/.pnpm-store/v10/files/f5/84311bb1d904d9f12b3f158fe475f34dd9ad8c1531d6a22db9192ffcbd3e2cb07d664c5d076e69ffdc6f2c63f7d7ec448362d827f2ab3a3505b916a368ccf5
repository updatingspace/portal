{"version":3,"file":"AccordionSummary.js","sourceRoot":"../../../../../src","sources":["components/Accordion/AccordionSummary/AccordionSummary.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\n\nimport * as React from 'react';\n\nimport {KeyCode} from '../../../constants';\nimport {useUniqId} from '../../../hooks';\nimport type {DisclosureSummaryRenderFunctionProps} from '../../Disclosure/DisclosureSummary/DisclosureSummary';\nimport type {QAProps} from '../../types';\nimport {isOfType} from '../../utils/isOfType';\nimport {useAccordion} from '../AccordionContext';\nimport {accordionSummaryBlock} from '../constants';\n\nimport './AccordionSummary.scss';\n\nexport type AccordionSummaryRenderProps = DisclosureSummaryRenderFunctionProps & {\n    ref: (element: HTMLButtonElement | null) => void;\n};\n\nexport type AccordionSummaryProps = QAProps & {\n    children: (\n        props: DisclosureSummaryRenderFunctionProps,\n        defaultSummary: React.ReactElement,\n    ) => React.ReactElement;\n};\n\n/**\n * Marker component for detecting AccordionSummary in AccordionItem.\n * The actual rendering is done by AccordionSummaryContent inside Disclosure.Summary.\n */\nexport function AccordionSummary(_props: AccordionSummaryProps): React.ReactNode {\n    return null;\n}\n\nexport type AccordionSummaryContentProps = QAProps & {\n    children: (\n        props: AccordionSummaryRenderProps,\n        defaultSummary: React.ReactElement,\n    ) => React.ReactElement;\n    disclosureProps: DisclosureSummaryRenderFunctionProps;\n    defaultSummary: React.ReactElement;\n};\n\nexport function AccordionSummaryContent(props: AccordionSummaryContentProps) {\n    const {children, disclosureProps, defaultSummary} = props;\n    const {registerSummary, unregisterSummary, getSummaryRefs, arrowPosition, size, ariaLevel} =\n        useAccordion();\n\n    const summaryId = useUniqId();\n    const [buttonElement, setButtonElement] = React.useState<HTMLButtonElement | null>(null);\n\n    React.useEffect(() => {\n        if (buttonElement) {\n            const summaryRef = {\n                element: buttonElement,\n                disabled: buttonElement.disabled,\n            };\n            registerSummary(summaryId, summaryRef);\n        }\n\n        return () => {\n            unregisterSummary(summaryId);\n        };\n    }, [summaryId, buttonElement, registerSummary, unregisterSummary]);\n\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLButtonElement>) => {\n        if (\n            e.key === KeyCode.ARROW_DOWN ||\n            e.key === KeyCode.ARROW_UP ||\n            e.key === KeyCode.HOME ||\n            e.key === KeyCode.END\n        ) {\n            e.preventDefault();\n\n            const summaryRefs = getSummaryRefs();\n\n            if (summaryRefs.length === 0) {\n                return;\n            }\n\n            if (e.key === KeyCode.HOME) {\n                summaryRefs[0]?.element.focus();\n                return;\n            }\n\n            if (e.key === KeyCode.END) {\n                summaryRefs[summaryRefs.length - 1]?.element.focus();\n                return;\n            }\n\n            const currentIndex = summaryRefs.findIndex((ref) => ref.element === e.currentTarget);\n            if (currentIndex === -1) {\n                return;\n            }\n\n            const nextIndex =\n                e.key === KeyCode.ARROW_DOWN\n                    ? (currentIndex + 1) % summaryRefs.length\n                    : (currentIndex - 1 + summaryRefs.length) % summaryRefs.length;\n\n            summaryRefs?.[nextIndex]?.element.focus();\n        }\n    };\n\n    const enhancedProps: AccordionSummaryRenderProps = {\n        ...disclosureProps,\n        onKeyDown: (e: React.KeyboardEvent<HTMLButtonElement>) => {\n            handleKeyDown(e);\n            if (disclosureProps.onKeyDown) {\n                disclosureProps.onKeyDown(e);\n            }\n        },\n        ref: (element: HTMLButtonElement | null) => {\n            setButtonElement(element);\n        },\n    };\n\n    return (\n        <div\n            role={'heading'}\n            aria-level={ariaLevel}\n            className={accordionSummaryBlock({size, arrow_position: arrowPosition})}\n        >\n            {children(enhancedProps, defaultSummary)}\n        </div>\n    );\n}\n\nexport const isAccordionSummaryComponent = isOfType(AccordionSummary);\nAccordionSummary.displayName = 'AccordionSummary';\n"]}