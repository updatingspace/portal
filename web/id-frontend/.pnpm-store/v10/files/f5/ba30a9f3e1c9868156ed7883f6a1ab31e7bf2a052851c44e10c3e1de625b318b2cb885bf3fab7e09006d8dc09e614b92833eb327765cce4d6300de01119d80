{"version":3,"file":"Menu.js","sourceRoot":"../../../../../src","sources":["components/lab/Menu/Menu.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\nimport * as React from 'react';\n\nimport {\n    Composite,\n    CompositeItem,\n    FloatingList,\n    flip,\n    offset,\n    safePolygon,\n    shift,\n    useClick,\n    useDismiss,\n    useFloatingParentNodeId,\n    useFloatingRootContext,\n    useFloatingTree,\n    useHover,\n    useInteractions,\n    useListNavigation,\n    useRole,\n} from '@floating-ui/react';\nimport type {VirtualElement} from '@floating-ui/react';\n\nimport {useControlledState, useForkRef} from '../../../hooks';\nimport {Popup} from '../../Popup';\nimport {useDirection} from '../../theme';\nimport {block} from '../../utils/cn';\nimport {getElementRef} from '../../utils/getElementRef';\n\nimport {MenuContext} from './MenuContext';\nimport {MenuDivider} from './MenuDivider';\nimport {MenuItem} from './MenuItem';\nimport {MenuTrigger} from './MenuTrigger';\nimport type {MenuProps} from './types';\nimport {isComponentType} from './utils';\n\nimport './Menu.scss';\n\nconst b = block('lab-menu');\n\n// The component is needed to run submenu logic hooks.\n// We get <nodeId> of the Popup using \"useFloatingParentNodeId\" here\n// and <parentId> from using \"useFloatingParentNodeId\" outside the Popup.\nfunction MenuPopupContent({\n    open,\n    onRequestClose,\n    isNested,\n    children,\n    className,\n    style,\n    qa,\n}: Pick<MenuProps, 'children' | 'className' | 'style' | 'qa'> & {\n    open: boolean;\n    onRequestClose: () => void;\n    isNested: boolean;\n}) {\n    const tree = useFloatingTree();\n    const nodeId = useFloatingParentNodeId();\n    const parentId = React.useContext(MenuContext)?.floatingParentId;\n\n    React.useEffect(() => {\n        if (!tree) return;\n\n        function handleTreeClick() {\n            // Closing only the root Menu so the closing animation runs once for all menus due to shared portal container\n            if (!isNested) {\n                onRequestClose();\n            }\n        }\n\n        function handleSubMenuOpen(event: {nodeId: string; parentId: string}) {\n            // Closing on sibling submenu open\n            if (event.nodeId !== nodeId && event.parentId === parentId) {\n                onRequestClose();\n            }\n        }\n\n        tree.events.on('click', handleTreeClick);\n        tree.events.on('menuopen', handleSubMenuOpen);\n\n        return () => {\n            tree.events.off('click', handleTreeClick);\n            tree.events.off('menuopen', handleSubMenuOpen);\n        };\n    }, [onRequestClose, tree, nodeId, parentId, isNested]);\n\n    React.useEffect(() => {\n        if (open && tree) {\n            tree.events.emit('menuopen', {parentId, nodeId});\n        }\n    }, [open, tree, nodeId, parentId]);\n\n    return (\n        <div className={b(null, className)} style={style} data-qa={qa}>\n            {children}\n        </div>\n    );\n}\n\nexport function Menu({\n    trigger,\n    inline = false,\n    defaultOpen,\n    open,\n    onOpenChange,\n    placement = 'bottom-start',\n    disabled,\n    children,\n    size = 'm',\n    className,\n    style,\n    qa,\n}: MenuProps) {\n    const [anchorElement, setAnchorElement] = React.useState<HTMLElement | null>(null);\n    const [floatingElement, setFloatingElement] = React.useState<HTMLDivElement | null>(null);\n    const [isOpen, setIsOpen] = useControlledState(open, defaultOpen ?? false, onOpenChange);\n    const [activeIndex, setActiveIndex] = React.useState<number | null>(null);\n\n    const isRTL = useDirection() === 'rtl';\n\n    const itemsRef = React.useRef<Array<HTMLElement | null>>([]);\n    const parentMenu = React.useContext(MenuContext);\n\n    const floatingParentId = useFloatingParentNodeId();\n    const isNested = Boolean(parentMenu);\n\n    const floatingContext = useFloatingRootContext({\n        open: isOpen && !disabled,\n        onOpenChange: setIsOpen,\n        elements: {\n            reference: anchorElement,\n            floating: floatingElement,\n        },\n    });\n    const hover = useHover(floatingContext, {\n        enabled: isNested,\n        delay: {open: 100},\n        handleClose: safePolygon({blockPointerEvents: true}),\n    });\n    const click = useClick(floatingContext, {\n        toggle: !isNested,\n        ignoreMouse: isNested,\n    });\n    const dismiss = useDismiss(floatingContext, {enabled: !isNested});\n    const role = useRole(floatingContext, {role: 'menu'});\n    const listNavigation = useListNavigation(floatingContext, {\n        listRef: itemsRef,\n        activeIndex,\n        nested: isNested,\n        onNavigate: setActiveIndex,\n        rtl: isRTL,\n    });\n    const detectOverflowOptions = {\n        padding: 4,\n    };\n    const middlewares = [\n        offset({mainAxis: isNested ? 3 : 4, alignmentAxis: isNested ? -4 : 0}),\n        flip({...detectOverflowOptions}),\n        shift({...detectOverflowOptions}),\n    ];\n    const interactions = [hover, click, dismiss, role, listNavigation];\n    const {getReferenceProps, getItemProps} = useInteractions(interactions);\n\n    const anchorRef = useForkRef(\n        setAnchorElement,\n        React.isValidElement(trigger) ? getElementRef(trigger) : undefined,\n    );\n    const anchorProps = React.isValidElement<any>(trigger)\n        ? getReferenceProps(trigger.props)\n        : getReferenceProps();\n    const anchorNode = React.isValidElement<any>(trigger)\n        ? React.cloneElement(trigger, {\n              ...anchorProps,\n              ref: anchorRef,\n          })\n        : typeof trigger === 'function'\n          ? trigger(anchorProps, anchorRef)\n          : null;\n\n    const handleContentRequestClose = React.useCallback(() => {\n        setIsOpen(false);\n    }, [setIsOpen]);\n\n    const getItemPropsInline = React.useCallback(\n        (userProps?: React.HTMLAttributes<HTMLElement>) => {\n            const handleItemPointerEnter = (event: React.PointerEvent<HTMLElement>) => {\n                userProps?.onPointerEnter?.(event);\n\n                const element = event.currentTarget;\n                const index = [\n                    ...(element.closest('[role=\"menu\"]')?.querySelectorAll('[role=\"menuitem\"]') ??\n                        []),\n                ].indexOf(element);\n\n                if (\n                    !(element as HTMLButtonElement).disabled &&\n                    !element.ariaDisabled &&\n                    index >= 0\n                ) {\n                    element.focus();\n                    setActiveIndex(index);\n                } else {\n                    setActiveIndex(null);\n                }\n            };\n\n            const handleItemPointerLeave = (event: React.PointerEvent<HTMLElement>) => {\n                userProps?.onPointerLeave?.(event);\n                setActiveIndex(null);\n            };\n\n            return {\n                // Clear attribute set by Floating UI Composite (we don't use it)\n                'data-active': undefined,\n                ...userProps,\n                onPointerEnter: handleItemPointerEnter,\n                onPointerLeave: handleItemPointerLeave,\n            };\n        },\n        [],\n    );\n\n    const contextValue = React.useMemo(\n        () => ({\n            inline: parentMenu?.inline ?? inline,\n            size: parentMenu?.size ?? size,\n            activeIndex,\n            floatingParentId: floatingParentId,\n            getItemProps: inline ? getItemPropsInline : getItemProps,\n        }),\n        [parentMenu, inline, size, activeIndex, floatingParentId, getItemPropsInline, getItemProps],\n    );\n\n    React.useEffect(() => {\n        if (!anchorNode) {\n            if (trigger) {\n                floatingContext.refs.setPositionReference(trigger as VirtualElement);\n                setIsOpen(true);\n            } else {\n                setIsOpen(false);\n            }\n        }\n    }, [trigger]);\n\n    if (inline) {\n        const preparedChildren = React.Children.toArray(children).map((child, index) => {\n            if (!React.isValidElement(child) || !isComponentType(child, 'Menu.Item')) {\n                return child;\n            }\n\n            return (\n                <CompositeItem\n                    key={index}\n                    render={(props) => React.cloneElement(child, {...child.props, ...props})}\n                />\n            );\n        });\n\n        return (\n            <MenuContext.Provider value={contextValue}>\n                <Composite\n                    render={\n                        <div\n                            role=\"menu\"\n                            className={b(null, className)}\n                            style={style}\n                            data-qa={qa}\n                        />\n                    }\n                    orientation=\"vertical\"\n                    loop={false}\n                    rtl={isRTL}\n                    activeIndex={activeIndex ?? undefined}\n                    onNavigate={setActiveIndex}\n                >\n                    {preparedChildren}\n                </Composite>\n            </MenuContext.Provider>\n        );\n    }\n\n    return (\n        <React.Fragment>\n            {anchorNode}\n            <Popup\n                open={floatingContext.open}\n                placement={isNested ? `${isRTL ? 'left' : 'right'}-start` : placement}\n                disablePortal={isNested}\n                disableEscapeKeyDown={isNested}\n                disableOutsideClick={isNested}\n                floatingContext={floatingContext}\n                floatingRef={setFloatingElement}\n                floatingMiddlewares={middlewares}\n                floatingInteractions={interactions}\n            >\n                <MenuContext.Provider value={contextValue}>\n                    <FloatingList elementsRef={itemsRef}>\n                        <MenuPopupContent\n                            open={isOpen}\n                            onRequestClose={handleContentRequestClose}\n                            isNested={isNested}\n                            className={className}\n                            style={style}\n                            qa={qa}\n                        >\n                            {children}\n                        </MenuPopupContent>\n                    </FloatingList>\n                </MenuContext.Provider>\n            </Popup>\n        </React.Fragment>\n    );\n}\n\nMenu.displayName = 'Menu';\n\nMenu.Trigger = MenuTrigger;\nMenu.Item = MenuItem;\nMenu.Divider = MenuDivider;\n"]}