{"version":3,"file":"AccordionItem.js","sourceRoot":"../../../../../src","sources":["components/Accordion/AccordionItem/AccordionItem.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\n\nimport * as React from 'react';\n\nimport {useUniqId} from '../../../hooks';\nimport {Disclosure} from '../../Disclosure';\nimport {DefaultDisclosureSummary} from '../../Disclosure/DisclosureSummary/DisclosureSummary';\nimport type {QAProps} from '../../types';\nimport {useAccordion} from '../AccordionContext';\nimport {\n    AccordionSummaryContent,\n    isAccordionSummaryComponent,\n} from '../AccordionSummary/AccordionSummary';\nimport type {AccordionSummaryProps} from '../AccordionSummary/AccordionSummary';\nimport {\n    accordionDetailsBlock,\n    accordionItemBlock,\n    accordionSummaryTriggerBlock,\n} from '../constants';\n\nimport './AccordionItem.scss';\n\nexport type AccordionItemProps = {\n    value?: string;\n    children?: React.ReactNode;\n    expanded?: boolean;\n    disabled?: boolean;\n    keepMounted?: boolean;\n    onUpdate?: (expanded: boolean) => void;\n    defaultExpanded?: boolean;\n    className?: string;\n    summary?: React.ReactNode;\n} & QAProps;\n\nexport const AccordionItem = React.forwardRef<HTMLDivElement, AccordionItemProps>(\n    function AccordionItem(props, _ref) {\n        const {\n            children,\n            expanded,\n            defaultExpanded,\n            disabled,\n            keepMounted,\n            value,\n            summary,\n            onUpdate,\n            qa,\n        } = props;\n\n        const attributes = useAccordion();\n        const {id, isExpanded, handleUpdate} = useAccordionItemState({\n            expanded,\n            defaultExpanded,\n            value,\n            onUpdate,\n        });\n\n        const [preparedSummary, details] = React.useMemo(() => {\n            return prepareChildren(children, qa);\n        }, [children, qa]);\n\n        return (\n            <Disclosure\n                key={value ?? id}\n                arrowPosition={attributes?.arrowPosition}\n                keepMounted={keepMounted}\n                onUpdate={handleUpdate}\n                expanded={defaultExpanded ? undefined : isExpanded}\n                defaultExpanded={defaultExpanded}\n                summary={summary}\n                disabled={disabled}\n                qa={qa}\n                className={accordionItemBlock({\n                    size: attributes?.size,\n                    view: attributes?.view,\n                    disabled,\n                })}\n            >\n                {preparedSummary}\n                <Disclosure.Details className={accordionDetailsBlock}>{details}</Disclosure.Details>\n            </Disclosure>\n        );\n    },\n);\n\nfunction useAccordionItemState({\n    expanded,\n    defaultExpanded,\n    value,\n    onUpdate,\n}: {\n    expanded?: boolean;\n    defaultExpanded?: boolean;\n    value?: string;\n    onUpdate?: (next: boolean) => void;\n}) {\n    const id = useUniqId();\n    const {items, updateItems} = useAccordion();\n    const isControlledItem = expanded !== undefined;\n    const hasDefaultState = defaultExpanded !== undefined;\n\n    const isExpanded = React.useMemo(() => {\n        if (isControlledItem) {\n            return expanded;\n        }\n\n        if (hasDefaultState) {\n            return false;\n        }\n\n        if (Array.isArray(items)) {\n            return items.includes(value ?? id);\n        }\n\n        return items === (value ?? id);\n    }, [isControlledItem, expanded, hasDefaultState, items, value, id]);\n\n    const handleUpdate = React.useCallback(\n        (next: boolean) => {\n            onUpdate?.(next);\n            if (!isControlledItem && !hasDefaultState) {\n                updateItems(value ?? id);\n            }\n        },\n        [onUpdate, isControlledItem, hasDefaultState, updateItems, value, id],\n    );\n    return {id, isExpanded, handleUpdate};\n}\n\nfunction prepareChildren(children: React.ReactNode, qa?: string) {\n    const items = React.Children.toArray(children);\n    let accordionSummaryElement: React.ReactElement<AccordionSummaryProps> | undefined;\n    let details: React.ReactNode;\n\n    const content: React.ReactNode[] = [];\n    for (const item of items) {\n        const isAccordionSummary = isAccordionSummaryComponent(item);\n        if (isAccordionSummary) {\n            if (accordionSummaryElement) {\n                throw new Error('Only one <Accordion.Summary> component is allowed');\n            }\n            accordionSummaryElement = item;\n            continue;\n        }\n        content.push(item);\n    }\n\n    if (content.length > 0) {\n        details = <React.Fragment>{content}</React.Fragment>;\n    }\n\n    const summaryQa = qa ? `${qa}-summary` : undefined;\n\n    const summaryChildren =\n        accordionSummaryElement?.props?.children ??\n        ((props) => (\n            <DefaultDisclosureSummary\n                {...props}\n                qa={summaryQa}\n                className={accordionSummaryTriggerBlock}\n            />\n        ));\n\n    const summary = (\n        <Disclosure.Summary qa={accordionSummaryElement?.props?.qa ?? summaryQa}>\n            {(disclosureProps, defaultSummary) => (\n                <AccordionSummaryContent\n                    disclosureProps={disclosureProps}\n                    defaultSummary={defaultSummary}\n                >\n                    {summaryChildren}\n                </AccordionSummaryContent>\n            )}\n        </Disclosure.Summary>\n    );\n\n    return [summary, details];\n}\n"]}