{"version":3,"file":"ColorPicker.js","sourceRoot":"../../../../../src","sources":["components/lab/ColorPicker/ColorPicker.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport type {HsvaColor} from '@uiw/react-color';\nimport {Alpha, Hue, Saturation, hsvaToHex, hsvaToHexa} from '@uiw/react-color';\n\nimport {useControlledState} from '../../../hooks/useControlledState';\nimport {Popup} from '../../Popup';\nimport {Select} from '../../Select';\n\nimport {ColorDisplay, ColorPointer, HexInput, RgbInputs} from './components';\nimport {DEFAULT_COLOR, b} from './constants';\nimport {Modes} from './types';\nimport {convertSelectedModeColorToHsva, getTextValueByMode} from './utils';\n\nexport interface ColorPickerProps {\n    /*\n     * Picker size\n     */\n    size?: 's' | 'm' | 'l' | 'xl';\n    /*\n     * Color value for controlled state\n     */\n    value?: string;\n    /*\n     * Default color value\n     */\n    defaultValue?: string;\n    /*\n     * Called when user updates the color manually or via UI. Receives a HEX(A) string.\n     */\n    onUpdate?: (value: string) => void;\n    /*\n     * Open popup for controlled state\n     */\n    open?: boolean;\n    /*\n     * Open popup by default\n     */\n    defaultOpen?: boolean;\n    /*\n     * Open popup handler\n     */\n    onOpenChange?: (open: boolean) => void;\n    /*\n     *Enables alpha channel support for HEXA/RGBA mode and transparency slider.\n     */\n    withAlpha?: boolean;\n    /*\n     * Render only picker button without value\n     */\n    compact?: boolean;\n}\n\nexport const ColorPicker = ({\n    size,\n    value,\n    defaultValue = DEFAULT_COLOR,\n    onUpdate,\n    open,\n    onOpenChange,\n    defaultOpen = false,\n    withAlpha = false,\n    compact = false,\n}: ColorPickerProps) => {\n    const [anchor, setAnchor] = React.useState<HTMLDivElement | null>(null);\n    const [modeState, setModeState] = React.useState<Modes>(Modes.Hex);\n\n    const [color, setColor] = useControlledState(value, defaultValue, onUpdate);\n\n    const isInternalUpdateRef = React.useRef(false);\n\n    const [hsva, setHsva] = React.useState<HsvaColor>(() =>\n        convertSelectedModeColorToHsva(color, Modes.Hex, withAlpha),\n    );\n\n    React.useEffect(() => {\n        if (isInternalUpdateRef.current) {\n            isInternalUpdateRef.current = false;\n            return;\n        }\n        setHsva(convertSelectedModeColorToHsva(color, Modes.Hex, withAlpha));\n    }, [color, withAlpha]);\n\n    const [isOpen, setIsOpen] = useControlledState(open, defaultOpen, onOpenChange);\n\n    const [inputValue, setInputValue] = React.useState(() =>\n        getTextValueByMode(hsva, modeState, withAlpha),\n    );\n\n    React.useEffect(() => {\n        setInputValue(getTextValueByMode(hsva, modeState, withAlpha));\n    }, [hsva, modeState, withAlpha]);\n\n    const updateHsva = React.useCallback(\n        (updates: Partial<HsvaColor>) => {\n            const newHsva = {...hsva, ...updates};\n            setHsva(newHsva);\n\n            const newHexValue = withAlpha ? hsvaToHexa(newHsva) : hsvaToHex(newHsva);\n\n            isInternalUpdateRef.current = true;\n            setColor(newHexValue);\n        },\n        [hsva, setColor, withAlpha],\n    );\n\n    const handleModeChange = (newMode: Modes) => {\n        setModeState(newMode);\n    };\n\n    const handleInputChange = (val: string) => {\n        setInputValue(val);\n    };\n\n    const applyInputValue = React.useCallback(() => {\n        const newHsva = convertSelectedModeColorToHsva(inputValue, modeState, withAlpha);\n        setHsva(newHsva);\n\n        const newHexValue = withAlpha ? hsvaToHexa(newHsva) : hsvaToHex(newHsva);\n        isInternalUpdateRef.current = true;\n        setColor(newHexValue);\n    }, [inputValue, modeState, withAlpha, setColor]);\n\n    return (\n        <React.Fragment>\n            <ColorDisplay\n                hsva={hsva}\n                withAlpha={withAlpha}\n                onClick={() => setIsOpen(!isOpen)}\n                onColorChange={updateHsva}\n                ref={setAnchor}\n                size={size}\n                compact={compact}\n            />\n\n            <Popup\n                open={isOpen}\n                className={b('popup')}\n                placement={[\n                    'bottom-start',\n                    'bottom-end',\n                    'left-start',\n                    'left-end',\n                    'top-start',\n                    'top-end',\n                ]}\n                anchorElement={anchor}\n                onOpenChange={setIsOpen}\n                disableTransition\n            >\n                <div className={b('handlers-container')}>\n                    <Saturation\n                        hsva={hsva}\n                        onChange={(newColor) => updateHsva({...newColor, a: hsva.a})}\n                        className={b('saturation')}\n                        radius={4}\n                        pointer={(props) => (\n                            <ColorPointer\n                                left={props.left}\n                                top={props.top}\n                                transform={'translate(-50%, -50%)'}\n                            />\n                        )}\n                    />\n\n                    <Hue\n                        className={b('slider')}\n                        hue={hsva.h}\n                        onChange={(newHue) => updateHsva(newHue)}\n                        pointerProps={{className: b('pointer')}}\n                        radius={4}\n                        pointer={(props) => (\n                            <ColorPointer\n                                left={props.left}\n                                top={props.top}\n                                transform={'translate(-50%, -25%)'}\n                            />\n                        )}\n                    />\n\n                    {withAlpha && (\n                        <Alpha\n                            hsva={hsva}\n                            onChange={(newAlpha) => updateHsva(newAlpha)}\n                            className={b('slider')}\n                            pointerProps={{className: b('pointer')}}\n                            radius={4}\n                            pointer={(props) => (\n                                <ColorPointer\n                                    left={props.left}\n                                    top={props.top}\n                                    transform={'translate(-50%, -25%)'}\n                                />\n                            )}\n                        />\n                    )}\n\n                    <div className={b('inputs')}>\n                        <Select\n                            options={Object.values(Modes).map((val) => ({\n                                content: val,\n                                value: val,\n                            }))}\n                            multiple={false}\n                            value={[modeState]}\n                            onUpdate={(val) => handleModeChange(val[0] as Modes)}\n                        />\n\n                        {modeState === Modes.Hex && (\n                            <HexInput\n                                value={inputValue}\n                                withAlpha={withAlpha}\n                                onChange={handleInputChange}\n                                onBlur={applyInputValue}\n                            />\n                        )}\n\n                        {modeState === Modes.Rgb && (\n                            <RgbInputs\n                                hsva={hsva}\n                                withAlpha={withAlpha}\n                                onChange={(color) => updateHsva(color.hsva)}\n                            />\n                        )}\n                    </div>\n                </div>\n            </Popup>\n        </React.Fragment>\n    );\n};\n"]}