{"version":3,"file":"useListNavigation.js","sourceRoot":"../../../../src","sources":["hooks/useListNavigation/useListNavigation.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAE/B,OAAO,EAAC,OAAO,EAAC,2BAAwB;AACxC,OAAO,EAAC,eAAe,EAAC,oCAA2B;AAEnD,OAAO,EAAC,QAAQ,EAAC,sBAAmB;AACpC,OAAO,EAAC,WAAW,EAAC,yBAAsB;AAoB1C,MAAM,UAAU,iBAAiB,CAA2C,EACxE,KAAK,EACL,IAAI,EACJ,QAAQ,EACR,cAAc,GAAG,IAAI,EACrB,aAAa,GAAG,IAAI,EACpB,SAAS,EACT,QAAQ,GAAG,KAAK,EAChB,YAAY,GAAG,CAAC,CAAC,EACjB,eAAe,GAC4B;IAC3C,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAS,YAAY,CAAC,CAAC;IAEnF,MAAM,KAAK,GAAG,KAAK,CAAC,WAAW,CAAC,GAAG,EAAE;QACjC,kBAAkB,CAAC,YAAY,CAAC,CAAC;IACrC,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;IAEnB,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE;QACjB,IAAI,KAAK,EAAE,CAAC;YACR,KAAK,EAAE,CAAC;QACZ,CAAC;IACL,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;IAEnB,eAAe,CAAC,GAAG,EAAE;QACjB,IAAI,QAAQ,EAAE,CAAC;YACX,OAAO,SAAS,CAAC;QACrB,CAAC;QAED,MAAM,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QACxD,IAAI,CAAC,WAAW,EAAE,CAAC;YACf,OAAO,SAAS,CAAC;QACrB,CAAC;QAED,MAAM,MAAM,GAAG,SAAS,EAAE,OAAO,CAAC;QAClC,IAAI,CAAC,MAAM,EAAE,CAAC;YACV,OAAO,SAAS,CAAC;QACrB,CAAC;QAED,MAAM,aAAa,GAAG,CAAC,KAAoB,EAAE,EAAE;YAC3C,MAAM,oBAAoB,GAAG,eAAe,EAAE,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;YACvE,IAAI,oBAAoB,KAAK,KAAK,EAAE,CAAC;gBACjC,OAAO;YACX,CAAC;YAED,QAAQ,KAAK,CAAC,GAAG,EAAE,CAAC;gBAChB,KAAK,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;oBACtB,KAAK,CAAC,cAAc,EAAE,CAAC;oBAEvB,oBAAoB;oBACpB,kBAAkB,CAAC,CAAC,uBAAuB,EAAE,EAAE,CAC3C,WAAW,CAAC,KAAK,EAAE,uBAAuB,EAAE,CAAC,EAAE,IAAI,CAAC,CACvD,CAAC;oBAEF,MAAM;gBACV,CAAC;gBACD,KAAK,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;oBACpB,KAAK,CAAC,cAAc,EAAE,CAAC;oBAEvB,iBAAiB;oBACjB,kBAAkB,CAAC,CAAC,uBAAuB,EAAE,EAAE,CAC3C,QAAQ,CAAC,KAAK,EAAE,uBAAuB,EAAE,CAAC,EAAE,IAAI,CAAC,CACpD,CAAC;oBAEF,MAAM;gBACV,CAAC;gBACD,KAAK,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC;oBACrB,IAAI,CAAC,QAAQ,EAAE,CAAC;wBACZ,OAAO;oBACX,CAAC;oBAED,KAAK,CAAC,cAAc,EAAE,CAAC;oBAEvB,4BAA4B;oBAC5B,kBAAkB,CAAC,CAAC,uBAAuB,EAAE,EAAE,CAC3C,WAAW,CAAC,KAAK,EAAE,uBAAuB,EAAE,QAAQ,EAAE,IAAI,CAAC,CAC9D,CAAC;oBAEF,MAAM;gBACV,CAAC;gBACD,KAAK,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;oBACnB,IAAI,CAAC,QAAQ,EAAE,CAAC;wBACZ,OAAO;oBACX,CAAC;oBAED,KAAK,CAAC,cAAc,EAAE,CAAC;oBAEvB,yBAAyB;oBACzB,kBAAkB,CAAC,CAAC,uBAAuB,EAAE,EAAE,CAC3C,QAAQ,CAAC,KAAK,EAAE,uBAAuB,EAAE,QAAQ,EAAE,IAAI,CAAC,CAC3D,CAAC;oBAEF,MAAM;gBACV,CAAC;gBACD,KAAK,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;oBAChB,IAAI,CAAC,cAAc,EAAE,CAAC;wBAClB,OAAO;oBACX,CAAC;oBAED,KAAK,CAAC,cAAc,EAAE,CAAC;oBAEvB,8BAA8B;oBAC9B,kBAAkB,CAAC,CAAC,uBAAuB,EAAE,EAAE,CAC3C,QAAQ,CAAC,KAAK,EAAE,uBAAuB,EAAE,uBAAuB,EAAE,IAAI,CAAC,CAC1E,CAAC;oBAEF,MAAM;gBACV,CAAC;gBACD,KAAK,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;oBACf,IAAI,CAAC,aAAa,EAAE,CAAC;wBACjB,OAAO;oBACX,CAAC;oBAED,KAAK,CAAC,cAAc,EAAE,CAAC;oBAEvB,4BAA4B;oBAC5B,kBAAkB,CAAC,CAAC,uBAAuB,EAAE,EAAE,CAC3C,QAAQ,CAAC,KAAK,EAAE,uBAAuB,EAAE,uBAAuB,GAAG,CAAC,EAAE,IAAI,CAAC,CAC9E,CAAC;oBAEF,MAAM;gBACV,CAAC;YACL,CAAC;QACL,CAAC,CAAC;QAEF,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;QAElD,OAAO,GAAG,EAAE;YACR,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;QACzD,CAAC,CAAC;IACN,CAAC,EAAE;QACC,eAAe;QACf,SAAS;QACT,QAAQ;QACR,KAAK;QACL,eAAe;QACf,QAAQ;QACR,aAAa;QACb,cAAc;QACd,IAAI;KACP,CAAC,CAAC;IAEH,OAAO;QACH,eAAe;QACf,kBAAkB;QAClB,KAAK;KACR,CAAC;AACN,CAAC","sourcesContent":["import * as React from 'react';\n\nimport {KeyCode} from '../../constants';\nimport {useLayoutEffect} from '../useLayoutEffect';\n\nimport {moveBack} from './moveBack';\nimport {moveForward} from './moveForward';\n\nexport type UseListNavigationProps<ItemType, AnchorType> = {\n    items: ItemType[];\n    skip?: (item: ItemType) => boolean;\n    pageSize?: number;\n    processHomeKey?: boolean;\n    processEndKey?: boolean;\n    disabled?: boolean;\n    initialValue?: number;\n    anchorRef?: React.RefObject<AnchorType | null>;\n    onAnchorKeyDown?: (activeItemIndex: number, event: KeyboardEvent) => void | boolean;\n};\n\nexport type UseListNavigationResult = {\n    activeItemIndex: number;\n    setActiveItemIndex: React.Dispatch<React.SetStateAction<number>>;\n    reset: () => void;\n};\n\nexport function useListNavigation<ItemType, AnchorType extends HTMLElement>({\n    items,\n    skip,\n    pageSize,\n    processHomeKey = true,\n    processEndKey = true,\n    anchorRef,\n    disabled = false,\n    initialValue = -1,\n    onAnchorKeyDown,\n}: UseListNavigationProps<ItemType, AnchorType>): UseListNavigationResult {\n    const [activeItemIndex, setActiveItemIndex] = React.useState<number>(initialValue);\n\n    const reset = React.useCallback(() => {\n        setActiveItemIndex(initialValue);\n    }, [initialValue]);\n\n    React.useEffect(() => {\n        if (items) {\n            reset();\n        }\n    }, [items, reset]);\n\n    useLayoutEffect(() => {\n        if (disabled) {\n            return undefined;\n        }\n\n        const canNavigate = items.some((item) => !skip?.(item));\n        if (!canNavigate) {\n            return undefined;\n        }\n\n        const anchor = anchorRef?.current;\n        if (!anchor) {\n            return undefined;\n        }\n\n        const handleKeyDown = (event: KeyboardEvent) => {\n            const shouldProcessKeydown = onAnchorKeyDown?.(activeItemIndex, event);\n            if (shouldProcessKeydown === false) {\n                return;\n            }\n\n            switch (event.key) {\n                case KeyCode.ARROW_DOWN: {\n                    event.preventDefault();\n\n                    // Go 1 step forward\n                    setActiveItemIndex((previousActiveItemIndex) =>\n                        moveForward(items, previousActiveItemIndex, 1, skip),\n                    );\n\n                    break;\n                }\n                case KeyCode.ARROW_UP: {\n                    event.preventDefault();\n\n                    // Go 1 step back\n                    setActiveItemIndex((previousActiveItemIndex) =>\n                        moveBack(items, previousActiveItemIndex, 1, skip),\n                    );\n\n                    break;\n                }\n                case KeyCode.PAGE_DOWN: {\n                    if (!pageSize) {\n                        return;\n                    }\n\n                    event.preventDefault();\n\n                    // Go pageSize steps forward\n                    setActiveItemIndex((previousActiveItemIndex) =>\n                        moveForward(items, previousActiveItemIndex, pageSize, skip),\n                    );\n\n                    break;\n                }\n                case KeyCode.PAGE_UP: {\n                    if (!pageSize) {\n                        return;\n                    }\n\n                    event.preventDefault();\n\n                    // Go pageSize steps back\n                    setActiveItemIndex((previousActiveItemIndex) =>\n                        moveBack(items, previousActiveItemIndex, pageSize, skip),\n                    );\n\n                    break;\n                }\n                case KeyCode.HOME: {\n                    if (!processHomeKey) {\n                        return;\n                    }\n\n                    event.preventDefault();\n\n                    // Go to the start of the list\n                    setActiveItemIndex((previousActiveItemIndex) =>\n                        moveBack(items, previousActiveItemIndex, previousActiveItemIndex, skip),\n                    );\n\n                    break;\n                }\n                case KeyCode.END: {\n                    if (!processEndKey) {\n                        return;\n                    }\n\n                    event.preventDefault();\n\n                    // Go to the end of the list\n                    setActiveItemIndex((previousActiveItemIndex) =>\n                        moveBack(items, previousActiveItemIndex, previousActiveItemIndex + 1, skip),\n                    );\n\n                    break;\n                }\n            }\n        };\n\n        anchor.addEventListener('keydown', handleKeyDown);\n\n        return () => {\n            anchor.removeEventListener('keydown', handleKeyDown);\n        };\n    }, [\n        activeItemIndex,\n        anchorRef,\n        disabled,\n        items,\n        onAnchorKeyDown,\n        pageSize,\n        processEndKey,\n        processHomeKey,\n        skip,\n    ]);\n\n    return {\n        activeItemIndex,\n        setActiveItemIndex,\n        reset,\n    };\n}\n"]}