{"version":3,"file":"Toaster.js","sourceRoot":"../../../../src","sources":["components/Toaster/Toaster.ts"],"names":[],"mappings":";;;AAAA,oEAAsD;AAGtD,gEAAwD;AACxD,sDAA8C;AAC9C,4DAAoD;AAEpD,MAAa,OAAO;IAChB,8EAA8E;IACtE,cAAc,GAAG,KAAK,CAAC;IACvB,MAAM,GAAyB,EAAE,CAAC;IAClC,YAAY,GAChB,IAAI,2BAAY,EAAE,CAAC;IAEvB,OAAO;QACH,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC;IAChC,CAAC;IAED,GAAG,CAAC,KAAiB;QACjB,IAAI,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;QAE7B,IAAI,IAAA,mBAAQ,EAAC,UAAU,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC;YACnC,UAAU,GAAG,IAAA,yBAAW,EAAC,UAAU,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;QACrD,CAAC;QAED,IAAI,CAAC,MAAM,GAAG;YACV,GAAG,UAAU;YACb;gBACI,GAAG,KAAK;gBACR,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE;gBACnB,GAAG,EAAE,EAAC,OAAO,EAAE,IAAI,EAAC;aACvB;SACJ,CAAC;QAEF,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,MAAM,CAAC,IAAY;QACf,IAAI,CAAC,MAAM,GAAG,IAAA,yBAAW,EAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAE7C,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,SAAS;QACL,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QAEjB,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,MAAM,CAAC,IAAY,EAAE,eAAoC;QACrD,IAAI,CAAC,IAAA,mBAAQ,EAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC;YAC/B,OAAO;QACX,CAAC;QAED,MAAM,KAAK,GAAG,IAAA,6BAAa,EAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAE/C,IAAI,CAAC,MAAM,GAAG;YACV,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC;YAC9B;gBACI,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;gBACrB,GAAG,eAAe;aACrB;YACD,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC;SAClC,CAAC;QAEF,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,GAAG,CAAC,IAAY;QACZ,OAAO,IAAA,mBAAQ,EAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IACvC,CAAC;IAED,SAAS,CAAC,QAAgD;QACtD,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;QAE3E,IAAI,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,MAAM,EAAE,CAAC;QAClB,CAAC;QAED,OAAO,WAAW,CAAC;IACvB,CAAC;IAEO,MAAM;QACV,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;QAE7E,IAAI,CAAC,cAAc,GAAG,CAAC,WAAW,CAAC;IACvC,CAAC;CACJ;AAjFD,0BAiFC","sourcesContent":["import {EventEmitter} from '../../utils/EventEmitter';\n\nimport type {InternalToastProps, ToastProps, ToasterImplementation} from './types';\nimport {getToastIndex} from './utilities/getToastIndex';\nimport {hasToast} from './utilities/hasToast';\nimport {removeToast} from './utilities/removeToast';\n\nexport class Toaster implements ToasterImplementation {\n    /** We were tried to notify about toaster changes, but no one were listened */\n    private hasUndelivered = false;\n    private toasts: InternalToastProps[] = [];\n    private eventEmitter: EventEmitter<{'toasts-change': [InternalToastProps[]]}> =\n        new EventEmitter();\n\n    destroy() {\n        this.removeAll();\n        this.eventEmitter.destroy();\n    }\n\n    add(toast: ToastProps) {\n        let nextToasts = this.toasts;\n\n        if (hasToast(nextToasts, toast.name)) {\n            nextToasts = removeToast(nextToasts, toast.name);\n        }\n\n        this.toasts = [\n            ...nextToasts,\n            {\n                ...toast,\n                addedAt: Date.now(),\n                ref: {current: null},\n            },\n        ];\n\n        this.notify();\n    }\n\n    remove(name: string) {\n        this.toasts = removeToast(this.toasts, name);\n\n        this.notify();\n    }\n\n    removeAll() {\n        this.toasts = [];\n\n        this.notify();\n    }\n\n    update(name: string, overrideOptions: Partial<ToastProps>) {\n        if (!hasToast(this.toasts, name)) {\n            return;\n        }\n\n        const index = getToastIndex(this.toasts, name);\n\n        this.toasts = [\n            ...this.toasts.slice(0, index),\n            {\n                ...this.toasts[index],\n                ...overrideOptions,\n            },\n            ...this.toasts.slice(index + 1),\n        ];\n\n        this.notify();\n    }\n\n    has(name: string) {\n        return hasToast(this.toasts, name);\n    }\n\n    subscribe(listener: (toasts: InternalToastProps[]) => void) {\n        const unsubscribe = this.eventEmitter.subscribe('toasts-change', listener);\n\n        if (this.hasUndelivered) {\n            this.notify();\n        }\n\n        return unsubscribe;\n    }\n\n    private notify() {\n        const isDelivered = this.eventEmitter.notify('toasts-change', [this.toasts]);\n\n        this.hasUndelivered = !isDelivered;\n    }\n}\n"]}